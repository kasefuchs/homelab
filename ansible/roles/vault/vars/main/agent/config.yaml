---
# Directory where Vault agent config files will be stored.
vault_agent_config_dir: /etc/vault-agent

# Directory for additional Vault agent config.
vault_agent_config_include_dir: "{{ (vault_agent_config_dir, 'conf.d') | ansible.builtin.path_join }}"

# Directory for Vault agent auth credential files.
vault_agent_config_auth_dir: "{{ (vault_agent_config_dir, '.auth') | ansible.builtin.path_join }}"

# Directory where Vault agent data will be stored.
vault_agent_config_state_dir: /var/lib/vault-agent

# Path where the Vault Agent writes the Vault token.
vault_agent_config_token_sink_file: "{{ (vault_agent_config_state_dir, '.token') | ansible.builtin.path_join }}"

# Path to the file storing the AppRole Role ID.
vault_agent_config_auth_role_id_file: "{{ (vault_agent_config_auth_dir, 'role-id') | ansible.builtin.path_join }}"

# Path to the file storing the AppRole Secret ID.
vault_agent_config_auth_role_secret_id_file: "{{ (vault_agent_config_auth_dir, 'role-secret-id') | ansible.builtin.path_join }}"

# Full path to the main Vault agent config file.
vault_agent_config_file: "{{ (vault_agent_config_include_dir, 'config.hcl') | ansible.builtin.path_join }}"

# Full path to the Vault agent block config file.
vault_agent_config_block_file: "{{ (vault_agent_config_include_dir, 'block.hcl') | ansible.builtin.path_join }}"

# Directory where Vault agent certificate files will be stored in the config path.
vault_agent_config_cert_dir: "{{ (vault_agent_config_dir, 'certs') | ansible.builtin.path_join }}"

# Directory where Vault agent CA certificate files will be stored in the config path.
vault_agent_config_cert_ca_dir: "{{ (vault_agent_config_cert_dir, 'ca') | ansible.builtin.path_join }}"

# Directory where Vault agent entity certificate files will be stored in the config path.
vault_agent_config_cert_entity_dir: "{{ (vault_agent_config_cert_dir, 'entity') | ansible.builtin.path_join }}"

# User to run Vault agent as.
vault_agent_config_user: root

# Pebble service layer definition for the Vault agent service.
vault_agent_config_pebble_layer:
  services:
    vault-agent:
      override: replace
      startup: enabled
      command: "{{ vault_install_binary_file }} agent -config={{ vault_agent_config_include_dir }}"
      user: "{{ vault_agent_config_user }}"
      group: "{{ vault_install_group }}"
      requires: "{{ vault_agent_config_service_dependencies | reject('equalto', omit) }}"
      after: "{{ vault_agent_config_service_dependencies | reject('equalto', omit) }}"

# Path to the Pebble layer file that contains the Vault agent service config.
vault_agent_config_pebble_layer_file: "{{ (pebble_config_layer_dir, '004-vault-agent.yaml') | ansible.builtin.path_join }}"
